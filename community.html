<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Community</title>
    <style>
        :root { --bg: #020617; --text: #f8fafc; --accent: #22d3ee; }
        body { margin: 0; background: var(--bg); color: var(--text); font-family: sans-serif; }
        /* (디자인 CSS 생략 - index.html과 동일한 스타일 적용됨) */
        .container { padding: 40px; }
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 20px; margin-top: 20px; }
        .card { background: rgba(30,41,59,0.5); border: 1px solid #334155; border-radius: 16px; overflow: hidden; }
        .thumb { height: 180px; background: #1e293b; }
        .thumb img { width: 100%; height: 100%; object-fit: cover; }
        .info { padding: 15px; }
        .title { font-weight: bold; margin-bottom: 5px; }
        .meta { font-size: 0.8rem; color: #94a3b8; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Community Feed</h1>
        <p>Real-time creations from users.</p>
        <div class="grid" id="feed">Loading...</div>
    </div>

    <script>
        // ngrok 주소로 꼭 변경하세요!
        const API_BASE_URL = 'https://postumbilical-amiee-mystifiedly.ngrok-free.dev/api/v1';

        async function loadCommunity() {
            try {
                const res = await fetch(`${API_BASE_URL}/assets/community?limit=50`);
                const assets = await res.json();
                const feed = document.getElementById('feed');

                if (assets.length === 0) {
                    feed.innerHTML = '<p>No creations yet. Be the first!</p>';
                    return;
                }

                feed.innerHTML = assets.map(asset => `
                    <div class="card">
                        <div class="thumb">
                            <img src="${asset.input_image_url || ''}" onerror="this.style.display='none'">
                        </div>
                        <div class="info">
                            <div class="title">${asset.title}</div>
                            <div class="meta">Generated on ${new Date(asset.created_at).toLocaleDateString()}</div>
                        </div>
                    </div>
                `).join('');
            } catch (e) {
                console.error(e);
                document.getElementById('feed').innerHTML = 'Failed to load feed.';
            }
        }
        loadCommunity();
    </script>
</body>
</html>